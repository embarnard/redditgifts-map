<!DOCTYPE html>

<!--
redditgifts map maker, an open source project hosted by emilie barnard
emiliebarnard.com
-->

<html>
  <head>
  <link rel="icon" type="image/png" href="gift@2x.png"/>
  <title>redditgifts map</title>
  <link rel="stylesheet" type="text/css" href="stylesheet.css" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  
      <!--
<style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map-canvas { height: 100% }
    </style>
-->
	    <script type="text/javascript"
	      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBauEtRQ17iTKbRU3wC4QdFJ9ZzgJeHFF8&sensor=true">
	    </script>
	    
	    <script type="text/javascript"
	    	src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
	    </script>
	    
	    <script type="text/javascript" src="/retina.js"></script>
	    
	    <script type="text/javascript">
	    
	    var iconSizeX = 37; /* ratio should be close to 29/40 */
	    var iconSizeY = 51;
	    var homeIconDim = 28;
	    var map;
	    var shareLinkURL = "http://redditgiftsmap.com/s/?";
	    var privateLinkURL = "http://redditgiftsmap.com/?";
	    var loadedURL = window.location.href;  
	    //var bounds = new google.maps.LatLngBounds(new google.maps.LatLng(57.1, -137.9),new google.maps.LatLng(56.8, -53.2),new google.maps.LatLng(31, -90.7)); //set this so it fits to the default map loaded
	    var bounds = new google.maps.LatLngBounds(new google.maps.LatLng(39.828175, -98.579500));
	      function initialize() {
	       
	        var mapOptions = {
	          center: new google.maps.LatLng(39.828175, -98.579500),
	          zoom: 4, 
	          minZoom: 2,
	          maxZoom: 7,
	          streetViewControl: false
	        };
	       
	        map = new google.maps.Map(document.getElementById("map-canvas"),
	            mapOptions);
	            
	        
	          
	      	
	      	if (loadedURL.localeCompare("http://redditgiftsmap.com/") != 0 && loadedURL.localeCompare("http://www.redditgiftsmap.com/") != 0){ //case that we're loaded previously dropped pins from a private link
		      	loadHome();
		      	loadPins();
	      	}
	      }
		  
		  google.maps.event.addDomListener(window, 'load', initialize);
		  var geocoder;
		  var markersArray = new Array();
		  var gifteesArray = new Array();
		  var rematchesArray = new Array();
		  var homeMarker = new google.maps.Marker();
		  var pinWindows = new Array();
		  
		  
		  		var numberToExchange = {
		  			   		  /* use the python script (part two) to generate the below part of the number to exchange name lookup table: */
		  			   		 "0": "secret santa 2009",
		  			   		  "1": "arbitrary day 2010",
		  			   		  "2": "secret santa 2010",
		  			   		  "3": "r/books 2011",
		  			   		  "4": "r/craftexchange 2011",
		  			   		  "5": "r/snackexchange 2011",
		  			   		  "6": "arbitrary day 2011",
		  			   		  "7": "reddit trick or treat 2011",
		  			   		  "8": "coffee mugs and tea cups 2011",
		  			   		  "9": "secret santa 2011",
		  			   		  "10": "t-shirts 2012",
		  			   		  "11": "r/books 2012",
		  			   		  "12": "yarn exchange 2012",
		  			   		  "13": "cookbooks",
		  			   		  "14": "my little pony",
		  			   		  "15": "board games",
		  			   		  "16": "awesomesocks",
		  			   		  "17": "redditgifts for the troops",
		  			   		  "18": "arbitrary day 2012",
		  			   		  "19": "arbitrary day plus",
		  			   		  "20": "presents for pets",
		  			   		  "21": "vinyl exchange",
		  			   		  "22": "decorate your dorm",
		  			   		  "23": "comic books and graphic novels",
		  			   		  "24": "reddit gifts for the teachers",
		  			   		  "25": "doctor who",
		  			   		  "26": "postcards",
		  			   		  "27": "ties",
		  			   		  "28": "makeup and nail polish",
		  			   		  "29": "decorate my cubicle",
		  			   		  "30": "reddit trick or treat plus",
		  			   		  "31": "reddit trick or treat 2012",
		  			   		  "32": "secret santa 2012",
		  			   		  "33": "holiday greeting card exchange",
		  			   		  "34": "pokemon exchange",
		  			   		  "35": "snack exchange 2013",
		  			   		  "36": "hats and scarves exchange",
		  			   		  "37": "coffee and tea exchange",
		  			   		  "38": "socks exchange",
		  			   		  "39": "book exchange 2013",
		  			   		  "40": "yarn exchange 2013",
		  			   		  "41": "fantasy exchange",
		  			   		  "42": "adventure time exchange",
		  			   		  "43": "t-shirt exchange",
		  			   		  "44": "manga exchange",
		  			   		  "45": "horror exchange",
		  			   		  "46": "awesome smell exchange",
		  			   		  "47": "simple pleasures exchange",
		  			   		  "48": "art prints exchange",
		  			   		  "49": "plushy exchange",
		  			   		  "50": "condiments exchange",
		  			   		  "51": "star wars exchange",
		  			   		  "52": "ameristralia exchange",
		  			   		  "53": "phone cases exchange",
		  			   		  "54": "doctor who (almost) 50th anniversary exchange",
		  			   		  "55": "pens and stationery exchange",
		  			   		  "56": "disney exchange",
		  			   		  "57": "star trek exchange",
		  			   		  "58": "nostalgia exchange",
		  			   		  "59": "arbitrary day plus 2013",
		  			   		  "60": "arbitrary day 2013",
		  			   		  "61": "nintendo exchange",
		  			   		  "62": "pints and shot glasses exchange",
		  			   		  "63": "magnets exchange",
		  			   		  "64": "game of thrones exchange",
		  			   		  "65": "hometown exchange",
		  			   		  "66": "arrested development exchange",
		  			   		  "67": "now sharing absurdity - the nsa gift exchange",
		  			   		  "68": "the world's end exchange plus",
		  			   		  "69": "the world's end exchange",
		  			   		  "70": "redditgifts for the teachers 2013",
		  			   		  "71": "zombies",
		  			   		  "72": "trading card games",
		  			   		  "73": "kitchen goods",
		  			   		  "74": "breaking bad",
		  			   		  "75": "board games 2013",
		  			   		  "76": "avatar: the last airbender",
		  			   		  "77": "nfl",
		  			   		  "78": "blind boxes and bags",
		  			   		  "79": "whedon-verse",
		  			   		  "80": "presents for pets 2013",
		  			   		  "81": "reddit trick or treat 2013 plus",
		  			   		  "82": "reddit trick or treat 2013",
		  			   		  "83": "secret santa 2013",
		  			   		  "84": "holiday cards 2013",
		  			   		  "85": "dinosaurs",
		  			   		  "86": "studio ghibli",
		  			   		  "87": "awesome aprons",
		  			   		  "88": "lunchboxes",
		  			   		  "89": "harry potter",
		  			   		  "90": "dc comics",
		  			   		  "91": "100th exchange extravaganza!",
		  			   		  "92": "snacks 2014",
		  			   		  "93": "socks 2014",
		  			   		  "94": "yarn 2014",
		  			   		  "95": "stickers",
		  			   		  "96": "lego",
		  			   		  "97": "jim henson",
		  			   		  "98": "ghostbusters",
		  			   		  "99": "books 2014",
		  			   		  "100": "archer",
		  			   		  "101": "ties 2014",
		  			   		  "102": "t-shirt 2014",
		  			   		  "103": "soccer",
		  			   		  "104": "tabletop rpgs",
		  			   		  "105": "puzzles",
		  			   		  "106": "ugly mugs",
		  			   		  "107": "marvel universe",
		  			   		  "108": "makeup & nail polish 2014",
		  			   		  "109": "hockey",
		  			   		  "110": "tim burton"		   		  /* use the python script (part two) to generate the above part of the number to exchange lookup table: */	
		  		   		  }; 

		  
			  var exchangeNumber = {
					/* use the python script (part two) to generate the below part of the exchange name to number lookup table: */
					"Secret Santa 2009": 0,
					"Arbitrary Day 2010": 1,
					"Secret Santa 2010": 2,
					"r/books 2011": 3,
					"r/craftexchange 2011": 4,
					"r/snackexchange 2011": 5,
					"Arbitrary Day 2011": 6,
					"reddit Trick or Treat 2011": 7,
					"Coffee Mugs and Tea Cups 2011": 8,
					"Secret Santa 2011": 9,
					"T-Shirts 2012": 10,
					"r/books 2012": 11,
					"yarn exchange 2012": 12,
					"Cookbooks": 13,
					"My Little Pony": 14,
					"Board Games": 15,
					"Awesomesocks": 16,
					"redditgifts for the troops": 17,
					"Arbitrary Day 2012": 18,
					"Arbitrary Day PLUS": 19,
					"Presents for Pets": 20,
					"Vinyl Exchange": 21,
					"Decorate Your Dorm": 22,
					"Comic Books and Graphic Novels": 23,
					"reddit Gifts for the Teachers": 24,
					"Doctor Who": 25,
					"Postcards": 26,
					"Ties": 27,
					"Makeup and Nail Polish": 28,
					"Decorate my Cubicle": 29,
					"reddit Trick or Treat PLUS": 30,
					"reddit Trick or Treat 2012": 31,
					"Secret Santa 2012": 32,
					"Holiday Greeting Card Exchange": 33,
					"Pokemon Exchange": 34,
					"Snack Exchange 2013": 35,
					"Hats and Scarves Exchange": 36,
					"Coffee and Tea Exchange": 37,
					"Socks Exchange": 38,
					"Book Exchange 2013": 39,
					"Yarn Exchange 2013": 40,
					"Fantasy Exchange": 41,
					"Adventure Time Exchange": 42,
					"T-shirt Exchange": 43,
					"Manga Exchange": 44,
					"Horror Exchange": 45,
					"Awesome Smell Exchange": 46,
					"Simple Pleasures Exchange": 47,
					"Art Prints Exchange": 48,
					"Plushy Exchange": 49,
					"Condiments Exchange": 50,
					"Star Wars Exchange": 51,
					"Ameristralia Exchange": 52,
					"Phone Cases Exchange": 53,
					"Doctor Who (Almost) 50th Anniversary Exchange": 54,
					"Pens and Stationery Exchange": 55,
					"Disney Exchange": 56,
					"Star Trek Exchange": 57,
					"Nostalgia Exchange": 58,
					"Arbitrary Day PLUS 2013": 59,
					"Arbitrary Day 2013": 60,
					"Nintendo Exchange": 61,
					"Pints and Shot Glasses Exchange": 62,
					"Magnets Exchange": 63,
					"Game of Thrones Exchange": 64,
					"Hometown Exchange": 65,
					"Arrested Development Exchange": 66,
					"Now Sharing Absurdity - The NSA Gift Exchange": 67,
					"The World's End Exchange PLUS": 68,
					"The World's End Exchange": 69,
					"redditgifts for the Teachers 2013": 70,
					"Zombies": 71,
					"Trading Card Games": 72,
					"Kitchen Goods": 73,
					"Breaking Bad": 74,
					"Board Games 2013": 75,
					"Avatar: The Last Airbender": 76,
					"NFL": 77,
					"Blind Boxes and Bags": 78,
					"Whedon-Verse": 79,
					"Presents for Pets 2013": 80,
					"reddit Trick or Treat 2013 PLUS": 81,
					"reddit Trick or Treat 2013": 82,
					"Secret Santa 2013": 83,
					"Holiday Cards 2013": 84,
					"Dinosaurs": 85,
					"Studio Ghibli": 86,
					"Awesome Aprons": 87,
					"Lunchboxes": 88,
					"Harry Potter": 89,
					"DC Comics": 90,
					"100th Exchange Extravaganza!": 91,
					"Snacks 2014": 92,
					"Socks 2014": 93,
					"Yarn 2014": 94,
					"Stickers": 95,
					"LEGO": 96,
					"Jim Henson": 97,
					"Ghostbusters": 98,
					"Books 2014": 99,
					"Archer": 100,
					"Ties 2014": 101,
					"T-shirt 2014": 102,
					"Soccer": 103,
					"Tabletop RPGs": 104,
					"Puzzles": 105,
					"Ugly Mugs": 106,
					"Marvel Universe": 107,
					"Makeup & Nail Polish 2014": 108,
					"Hockey": 109,
					"Tim Burton": 110
				/* use the python script (part two) to generate the above part of the exchange name to number lookup table: */	  
			  }; 
			  
			  var exchangeImageURL = {
					/* use the python script (part three) to generate the below part of the exchange number to image url lookup table: */
					"0": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/secret-santa-2009-logo/ss09.png",
					"1": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/arbitrary-day-2010-logo/ad10.png",
					"2": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/secret-santa-2010-logo/ss10.png",
					"3": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/rbooks-1-logo/rbooks_logo_1.png",
					"4": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/rcraftexchange-1-logo/rcraftexchange.png",
					"5": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/rsnackexchange-1-logo/rsnackexchange.png",
					"6": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/ad112.png",
					"7": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/halloween-logo/halloween.png",
					"8": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/coffee-mugs-and-tea-cups-logo/mugs.png",
					"9": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/secret-santa-2011/ss_2012.gif",
					"10": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/2/8/t-shirts-1328741603.gif",
					"11": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/rbooks-1-logo/rbooks_logo_1.png",
					"12": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/2/8/yarn-1328741654.gif",
					"13": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/3/23/cookbooks-1332525041.png",
					"14": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/3/23/my-little-pony-1332524825.png",
					"15": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/3/23/boardgames-1332524567.png",
					"16": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/3/23/socks-1332524236.png",
					"17": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/5/20/reddit-gifts-troops-1337581720.gif",
					"18": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/5/28/arbitrary-day-2012-1338262732.gif",
					"19": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/5/28/arbitrary-day-plus-1338262762.gif",
					"20": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/7/27/pets-1343427049.png",
					"21": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/7/27/vinyl-1343426989.png",
					"22": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/7/27/dorm-1343427073.png",
					"23": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/7/27/comics-1343427092.png",
					"24": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/7/27/teachers-1343427017.png",
					"25": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/9/6/dr-who-1346968838.png",
					"26": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/9/6/postcards-1346968317.png",
					"27": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/9/6/ties-1346967805.png",
					"28": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/9/7/makeup-1347032272.png",
					"29": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/9/6/decorate-my-cubicle-1346965985.png",
					"30": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/halloween-logo/halloween.png",
					"31": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/halloween-logo/halloween.png",
					"32": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/11/2/secret-santa-2012-1351877009.gif",
					"33": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/12/3/holiday-greeting-cards-1354552546.png",
					"34": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/1/25/pokemon-1359146410.png",
					"35": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/rsnackexchange-1-logo/rsnackexchange.png",
					"36": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/1/25/hats-and-scarves-1359146254.png",
					"37": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/1/24/coffee-and-tea-1359055910.png",
					"38": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/1/23/socks-new-1358981287.png",
					"39": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/rbooks-1-logo/rbooks_logo_1.png",
					"40": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/2/8/yarn-1328741654.gif",
					"41": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/2/27/fantasy-1362003804.png",
					"42": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/2/27/adventure-time-1362003660.png",
					"43": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/2/27/tshirts-2013-1362003634.png",
					"44": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/2/27/manga-1362003596.png",
					"45": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/2/27/horror-1362003540.png",
					"46": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/3/28/awesome-smell-1364496332.png",
					"47": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/3/28/simple-pleasures-1364496316.png",
					"48": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/3/28/art-prints-1364496295.png",
					"49": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/3/28/plushy-1364496280.png",
					"50": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/3/28/condiments-1364496260.png",
					"51": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/3/28/star-wars-1364496238.png",
					"52": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/4/29/ameristralia-1367253932.png",
					"53": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/4/25/phone-cases-1366931869.png",
					"54": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/9/6/dr-who-1346968838.png",
					"55": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/4/25/pens-and-stationary-1366931821.png",
					"56": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/4/25/disney-1366931887.png",
					"57": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/4/25/star-trek-1366931852.png",
					"58": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/4/25/nostalgia-1366931904.png",
					"59": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/5/16/arbitrary-day-plus-2013-1368760054.png",
					"60": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/5/16/arbitrary-day-2013-1368759955.png",
					"61": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/6/20/nintendo-1371762339.png",
					"62": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/4/25/pint-glasses-1366931924.png",
					"63": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/6/21/magnets-1371839333.png",
					"64": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/6/21/game-thrones-1371840210.png",
					"65": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/6/21/hometown-1371838981.png",
					"66": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/6/20/arrested-development-1371761674.png",
					"67": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/6/28/freedom-isnt-free-1372482060.png",
					"68": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/7/9/worlds-end-plus-1373400653.png",
					"69": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/6/24/worlds-end-1372098494.png",
					"70": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/8/16/teachers-2013-1376669257.png",
					"71": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/8/16/zombies-1376666915.png",
					"72": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/8/16/tcg-1376666823.png",
					"73": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/8/16/kitchen-goods-1376666870.png",
					"74": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/8/15/breaking-bad-1376634677.png",
					"75": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/8/15/board-games-2013-1376635231.png",
					"76": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/9/20/avatar-1379703050.png",
					"77": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/9/20/nfl-1379699443.png",
					"78": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/9/20/blind-boxes-and-bags-1379701023.png",
					"79": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/9/20/joss-1379699182.png",
					"80": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/9/20/presents-pets-2013-1379698807.png",
					"81": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/9/20/trick-or-treat-2013-plus-1379698290.png",
					"82": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/9/20/trick-or-treat-2013-1379698510.png",
					"83": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/11/2/secret-santa-2013-1383433440.png",
					"84": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/12/3/holiday-greeting-cards-1354552546.png",
					"85": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/1/5/dinosaurs-1388956140.png",
					"86": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/1/5/studio-ghibli-1388956046.png",
					"87": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/1/5/awesome-aprons-1388955970.png",
					"88": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/1/5/lunchboxes-1388955848.png",
					"89": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/1/5/harry-potter-1388955746.png",
					"90": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/1/5/dc-comics-1388955594.png",
					"91": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/2/15/100-1392497983.png",
					"92": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/rsnackexchange-1-logo/rsnackexchange.png",
					"93": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2013/1/23/socks-new-1358981287.png",
					"94": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/2/8/yarn-1328741654.gif",
					"95": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/2/9/stickers-1391969617.png",
					"96": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/2/9/lego-1391969361.png",
					"97": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/2/10/jim-henson-1392086804.png",
					"98": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/2/9/ghostbusters-1391969070.png",
					"99": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/2/9/books-2014-1391968957.png",
					"100": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/2/9/archer-1391968728.png",
					"101": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/9/6/ties-1346967805.png",
					"102": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/2/8/t-shirts-1328741603.gif",
					"103": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/3/19/soccer-1395244517.png",
					"104": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/3/19/rpg-1395244233.png",
					"105": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/3/19/puzzles-1395243100.png",
					"106": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/3/27/ugly-mugs-1395951198.png",
					"107": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/3/19/marvel-1395242664.png",
					"108": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2012/9/7/makeup-1347032272.png",
					"109": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/3/19/hockey-1395242271.png",
					"110": "https://d2npbuaakacvlz.cloudfront.net/images/uploaded/exchange-logo/2014/3/19/burton-1395241890.png"
					/* use the python script (part three) to generate the above part of the exchange number to image url lookup table: */
					};
					
					var exchangeNumberLowerCase = {
					   				/* use the python script (part two) to generate the below part of the exchange name to number lookup table: */
									"secret santa 2009": 0,
									"arbitrary day 2010": 1,
									"secret santa 2010": 2,
									"r/books 2011": 3,
									"r/craftexchange 2011": 4,
									"r/snackexchange 2011": 5,
									"arbitrary day 2011": 6,
									"reddit trick or treat 2011": 7,
									"coffee mugs and tea cups 2011": 8,
									"secret santa 2011": 9,
									"t-shirts 2012": 10,
									"r/books 2012": 11,
									"yarn exchange 2012": 12,
									"cookbooks": 13,
									"my little pony": 14,
									"board games": 15,
									"awesomesocks": 16,
									"redditgifts for the troops": 17,
									"arbitrary day 2012": 18,
									"arbitrary day plus": 19,
									"presents for pets": 20,
									"vinyl exchange": 21,
									"decorate your dorm": 22,
									"comic books and graphic novels": 23,
									"reddit gifts for the teachers": 24,
									"doctor who": 25,
									"postcards": 26,
									"ties": 27,
									"makeup and nail polish": 28,
									"decorate my cubicle": 29,
									"reddit trick or treat plus": 30,
									"reddit trick or treat 2012": 31,
									"secret santa 2012": 32,
									"holiday greeting card exchange": 33,
									"pokemon exchange": 34,
									"snack exchange 2013": 35,
									"hats and scarves exchange": 36,
									"coffee and tea exchange": 37,
									"socks exchange": 38,
									"book exchange 2013": 39,
									"yarn exchange 2013": 40,
									"fantasy exchange": 41,
									"adventure time exchange": 42,
									"t-shirt exchange": 43,
									"manga exchange": 44,
									"horror exchange": 45,
									"awesome smell exchange": 46,
									"simple pleasures exchange": 47,
									"art prints exchange": 48,
									"plushy exchange": 49,
									"condiments exchange": 50,
									"star wars exchange": 51,
									"ameristralia exchange": 52,
									"phone cases exchange": 53,
									"doctor who (almost) 50th anniversary exchange": 54,
									"pens and stationery exchange": 55,
									"disney exchange": 56,
									"star trek exchange": 57,
									"nostalgia exchange": 58,
									"arbitrary day plus 2013": 59,
									"arbitrary day 2013": 60,
									"nintendo exchange": 61,
									"pints and shot glasses exchange": 62,
									"magnets exchange": 63,
									"game of thrones exchange": 64,
									"hometown exchange": 65,
									"arrested development exchange": 66,
									"now sharing absurdity - the nsa gift exchange": 67,
									"the world's end exchange plus": 68,
									"the world's end exchange": 69,
									"redditgifts for the teachers 2013": 70,
									"zombies": 71,
									"trading card games": 72,
									"kitchen goods": 73,
									"breaking bad": 74,
									"board games 2013": 75,
									"avatar: the last airbender": 76,
									"nfl": 77,
									"blind boxes and bags": 78,
									"whedon-verse": 79,
									"presents for pets 2013": 80,
									"reddit trick or treat 2013 plus": 81,
									"reddit trick or treat 2013": 82,
									"secret santa 2013": 83,
									"holiday cards 2013": 84,
									"dinosaurs": 85,
									"studio ghibli": 86,
									"awesome aprons": 87,
									"lunchboxes": 88,
									"harry potter": 89,
									"dc comics": 90,
									"100th exchange extravaganza!": 91,
									"snacks 2014": 92,
									"socks 2014": 93,
									"yarn 2014": 94,
									"stickers": 95,
									"lego": 96,
									"jim henson": 97,
									"ghostbusters": 98,
									"books 2014": 99,
									"archer": 100,
									"ties 2014": 101,
									"t-shirt 2014": 102,
									"soccer": 103,
									"tabletop rpgs": 104,
									"puzzles": 105,
									"ugly mugs": 106,
									"marvel universe": 107,
									"makeup & nail polish 2014": 108,
									"hockey": 109,
									"tim burton": 110
					   			/* use the python script (part two) to generate the above part of the exchange name to number lookup table: */	  
					   		  }; 
		function loadHome(){
			//first we'll check for home info
			var userInfoInURL = "&";
			
			if (loadedURL.indexOf("http://redditgiftsmap.com/?") != -1){
				userInfoInURL = loadedURL.replace("http://redditgiftsmap.com/?","");
				loadedURL = loadedURL.replace("http://redditgiftsmap.com/?","");
			}
			else {
				userInfoInURL = loadedURL.replace("http://www.redditgiftsmap.com/?","");
				loadedURL = loadedURL.replace("http://www.redditgiftsmap.com/?","");
			}

			
			   		var userInfo = "";
			   		var i = 0;
			   		var commaCount = 0;
			   		var lat = "";
			   		var lng = "";
			   		var userName = "";
			   		
			   		while (userInfoInURL.charAt(i).localeCompare("&") != 0){
				   		userInfo += userInfoInURL.charAt(i);
				   		//comma check:
				   		if (userInfoInURL.charAt(i).localeCompare(",") == 0){
					   		commaCount ++;
				   		}
				   		i++;
			   		}
			   		i=0; //reset
			   		loadedURL = loadedURL.replace(userInfo + "&",""); //removes the user info from the loaded url, leaving just the info regarding giftee pins
			   		
			   		//if comma count is zero, no user info given
			   		if (commaCount > 0){
				   		
				   		//if comma count is one, we have the location but not the username:
				   		   		if (commaCount == 1){
				   			   		while (userInfo.charAt(i).localeCompare(",") != 0){
				   			   			lat += userInfo.charAt(i);
				   			   			i++;
				   			   		}
				   			   		lat = parseFloat(lat, "10");
				   			   		
				   			   		i++; //get past the comma
				   			   		
				   			   		while (i < userInfo.length){
				   				   		lng += userInfo.charAt(i);
				   				   		i++;
				   			   		}
				   			   		
				   			   		lng = parseFloat(lng, "10");
				   			   		
				   			   		shareLinkURL = "http://redditgiftsmap.com/s/?";
				   			   		privateLinkURL = "http://redditgiftsmap.com/?";
				   			   		
				   			   		shareLinkURL += lat.toFixed(1) + "," + lng.toFixed(1);
				   			   		privateLinkURL += lat.toFixed(1) + "," + lng.toFixed(1);
				   			   		
				   			   		
				   			   		//drop home pin:
				   			   		// geocoder = new google.maps.Geocoder();
				   			   		
				   			   		var homeDialog = '<div class="homeContent">' + '<p>home sweet home</p>' + '</div>';
				   			   		
				   			   		var homeWindow = new google.maps.InfoWindow({
				   			   			  content: homeDialog,
				   			   			  maxWidth: 100
				   			   		  });
				   			   		
				   			   			var pinPos = new google.maps.LatLng(lat, lng);
				   			   			
				   			   			//extend map to fit all pins
				   			   			bounds.extend(pinPos);
				   			   			map.fitBounds(bounds);
				   			   			
				   			   			var pinImg = {
				   			   				url: 'home@2x.png',
				   			   				scaledSize: new google.maps.Size(homeIconDim, homeIconDim),
				   			   				origin: new google.maps.Point(0, 0),
				   			   				anchor: new google.maps.Point(homeIconDim/2, homeIconDim/2)
				   			   			};
				   			   			homeMarker = new google.maps.Marker({
				   			   				position: pinPos,
				   			   				map: map,
				   			   				icon: pinImg,
				   			   				title: "Home Sweet Home"
				   			   			});
				   			   			google.maps.event.addListener(homeMarker, 'click', function() {
				   				   			for (var j = 0; j < pinWindows.length; j++){
				   				   				pinWindows[j].close();
				   				   			}
				   			   				homeWindow.open(map,this);
				   			   			  });
				   			   			  
				   			   			google.maps.event.addListener(homeMarker, 'rightclick', function() {
				   			   			    homeMarker.setMap(null);
				   			   			    homeMarker = null;
				   			   			    shareLinkURL = "http://redditgiftsmap.com/s/?";
				   			   			    privateLinkURL = "http://redditgiftsmap.com/?";
				   			   			  });  
				   			   			 
				   			   			 pinWindows.push(homeWindow);
				   		   		
				   			}
				   			
				   			//if comma count is two, we have the location and the username:
				   				   		   		if (commaCount == 2){
				   				   			   		//get username:
				   				   			   		while (userInfo.charAt(i).localeCompare(",") != 0){
				   				   				   		userName += userInfo.charAt(i);
				   				   				   		i++;
				   				   				   	}
				   				   				  	shareLinkURL += userName + ",";
				   				   				  	privateLinkURL += userName + ",";
				   				   				   	
				   				   				   	i++; //get past the comma
				   				   				   	
				   				   				   	//get position
				   				   				   	while (userInfo.charAt(i).localeCompare(",") != 0){
				   				   				   	   			lat += userInfo.charAt(i);
				   				   				   	   			i++;
				   				   					}
				   				   					lat = parseFloat(lat, "10");
				   				   					
				   				   					
				   				   					i++; //get past the comma
				   				   					
				   				   					while (i < userInfo.length){
				   				   					   	lng += userInfo.charAt(i);
				   				   					   	i++;
				   				   					}
				   				   					lng = parseFloat(lng, "10");
				   				   					
				   				   					shareLinkURL += lat.toFixed(1) + "," + lng.toFixed(1);
				   				   					privateLinkURL += lat.toFixed(1) + "," + lng.toFixed(1);
				   				   					//drop home pin:
				   				   					
				   				   					var homeDialog = '<div class="homeContent">' + '<p>home of <a href="http://reddit.com/u/' + userName + '" target="_blank">/u/' + userName + '</a></p>' + '</div>';
				   				   					
				   				   					var homeWindow = new google.maps.InfoWindow({
				   				   						  content: homeDialog,
				   				   						  maxWidth: 100
				   				   					  });
				   				   					var pinPos = new google.maps.LatLng(lat, lng);
				   				   					
				   				   					//extend map to fit all pins
				   				   					bounds.extend(pinPos);
				   				   					map.fitBounds(bounds);
				   				   					
				   				   					  
				   				   					  var pinImg = {
				   				   					  	url: 'home@2x.png',
				   				   					  	scaledSize: new google.maps.Size(homeIconDim, homeIconDim),
				   				   					  	origin: new google.maps.Point(0, 0),
				   				   					  	anchor: new google.maps.Point(homeIconDim/2, homeIconDim/2)
				   				   					  };
				   				   						
				   				   					  
				   				   					homeMarker = new google.maps.Marker({
				   				   						position: pinPos,
				   				   						map: map,
				   				   						icon: pinImg,
				   				   						title: "Home Sweet Home"
				   				   					});
				   				   					google.maps.event.addListener(homeMarker, 'click', function() {
				   				   						//close current windows
				   				   						for (var j = 0; j < pinWindows.length; j++){
				   				   							pinWindows[j].close();
				   				   						}
				   				   						homeWindow.open(map,this);
				   				   					  });
				   				   					  google.maps.event.addListener(homeMarker, 'rightclick', function() {
				   				   					     homeMarker.setMap(null);
				   				   					     homeMarker = null;
				   				   					     shareLinkURL = "http://redditgiftsmap.com/s/?";
				   				   					     privateLinkURL = "http://redditgiftsmap.com/?";
				   				   					   });  
				   				   					  
				   				   					  pinWindows.push(homeWindow);
				   				   					
				   				   						var pinPos = new google.maps.LatLng(lat, lng);
				   				   						
				   				   						var pinImg = {
				   				   							url: 'home@2x.png',
				   				   							scaledSize: new google.maps.Size(homeIconDim, homeIconDim),
				   				   							origin: new google.maps.Point(0, 0),
				   				   							anchor: new google.maps.Point(homeIconDim/2, homeIconDim/2)
				   				   						};
				   				   		
				   				   			}
	   		

				   	}

		}			   		  
		
		function dropThisPin(pinStuff){
			   	
			   	// var pinMarker = new google.maps.Marker();
			   	  	// var pinWindow = new google.maps.InfoWindow();
			   	  	var pinDialog = '<div class="pinContent">';
			   	  
			   	  	// first we split up the info
			   	  	var arrayOfThisPin = pinStuff.split(",");
			   	  	
			   	  	//name of exchange
			   	  	var exchange = numberToExchange[arrayOfThisPin[0]];
			   	  	
			   	  	//position of pin:
			   	  	var lat = arrayOfThisPin[1];
			   	  	var lng = arrayOfThisPin[2];
			   	  	var username = "";
			   	  			   	  	
			   		 	//now we have to check the optional parameters
			   		
			   		 	if (arrayOfThisPin.length == 5){	//case that all optional fields were filled out (username and it's a rematch case)
			   			username = arrayOfThisPin[3];
			   			pinDialog += '<p><b>exchange</b>: ' +  exchange + ' (rematch)';
			   			pinDialog += '<br><b>giftee</b>: <a href="http://reddit.com/u/' + username + '" target="_blank">/u/' + username + '</a>';
			   			rematchesArray.push(true);
			   		}
			   		
			   		if (arrayOfThisPin.length == 4 ){ //case that one optional field was filled out (username or rematch)
			   			if (arrayOfThisPin[3].localeCompare("") == 0){ //rematch case
			   		 	pinDialog += '<p><b>exchange</b>: ' +  exchange + ' (rematch)';
				   		rematchesArray.push(true);
			   			}
			   			else{ //username case
			   		 	username = arrayOfThisPin[3];
			   		 	pinDialog += '<p><b>exchange</b>: ' +  exchange;
			   		 	pinDialog += '<br><b>giftee</b>: <a href="http://reddit.com/u/' + username + '" target="_blank">/u/' + username + '</a>';
			   		 	rematchesArray.push(false);
			   			}
			   			
			   		}
			   		
			   		if (arrayOfThisPin.length == 3){ //required fields only case
			   			pinDialog += '<p><b>exchange</b>: ' +  exchange;
				   		rematchesArray.push(false);
			   		}
			   		
			   		pinDialog += '</p></div>';
			   		
			   		var pinWindow = new google.maps.InfoWindow({
			   			  content: pinDialog,
			   			  maxWidth: 150
			   			  });
			   		
			   		
			   		var pinPos = new google.maps.LatLng(lat, lng);
			   		
			   		//fit map to include new pin
			   		bounds.extend(pinPos);
			   		map.fitBounds(bounds);
			   		
			   		
			   		var pinImg = {
			   			url: exchangeImageURL[exchangeNumberLowerCase[exchange]],
			   			scaledSize: new google.maps.Size(iconSizeX, iconSizeY),
			   			origin: new google.maps.Point(0, 0),
			   			anchor: new google.maps.Point(iconSizeX/2, iconSizeY/2)
			   		};
			   		
			   		var pinMarker = new google.maps.Marker({
			   			position: pinPos,
			   			map: map,
			   			icon: pinImg,
			   			title: exchange
			   		});
			   		
			   		google.maps.event.addListener(pinMarker, 'click', function() {
				   		//close current windows
				   		for (var j = 0; j < pinWindows.length; j++){
				   			pinWindows[j].close();
				   		}
			   		  pinWindow.open(map,this);
			   		});
			   		
			   		pinWindows.push(pinWindow);
			   		
			   		google.maps.event.addListener(pinMarker, 'rightclick', function() {
			   			var markerIndex = markersArray.indexOf(pinMarker);
			   			
			   			pinMarker.setMap(null);
			   			pinMarker = null;
			   			
			   			
			   			markersArray.splice(markerIndex, 1);
			   			gifteesArray.splice(markerIndex, 1);
			   			rematchesArray.splice(markerIndex, 1);
			   			
			   			if (markersArray[markersArray.length-1] == null){
			   				document.getElementById("undoPinButton").disabled = true;
			   				document.getElementById("mapLinkButton").disabled = true;
			   		
			   		}
			   	});
			   	
			   	markersArray.push(pinMarker);
			   	gifteesArray.push(username);
		   	}
		   	
		   	
		   	
		function loadPins(){
			 //first we need to separate the pins
			    	// var pinInfoInURL = loadedURL.replace("http://redditgiftsmap.com/s/?&","");
			    	pinInfoInURL = loadedURL.slice(0, -1); //remove last &
			    	var arrayOfPinInfo = pinInfoInURL.split("&");

			    	//then we drop them like we did in other file
			    	for (var j = 0; j < arrayOfPinInfo.length; j++){
			 	   	dropThisPin(arrayOfPinInfo[j]);
			    	}

		}
		
		function dropPin(){
		
			if ( $('#exchangeList').val().localeCompare("") != 0 && $('#postCode').val().localeCompare("") != 0){	
				
				geocoder = new google.maps.Geocoder();
				var post = $('#postCode').val();
				var username = $('#gifteeUsername').val();
				var exchange = $('#exchangeList').val();
				var lat;
				var lng;
				var pinDialog = '<div class="pinContent">';
				
				/* alert( exchangeImageURL[exchangeNumber[exchange]]); */
								
				if ($('#rematchCheck').prop('checked')){
					/* alert('checked'); */
					pinDialog += '<p><b>exchange</b>: ' +  exchange + ' (rematch)';
					rematchesArray.push(true);	
				}
				
				else{
					pinDialog += '<p><b>exchange</b>: ' +  exchange
					rematchesArray.push(false);
				}
				
				if (username.localeCompare("") != 0){
					pinDialog += '<br><b>giftee</b>: <a href="http://reddit.com/u/' + username + '" target="_blank">/u/' + username + '</a>';
				}

				pinDialog += '</p></div>';
				
				var pinWindow = new google.maps.InfoWindow({
			      content: pinDialog,
			      maxWidth: 150
				  });
				geocoder.geocode({address: post},
				function(results_array, status) { 
					lat = results_array[0].geometry.location.lat();
					lng = results_array[0].geometry.location.lng();
				
					var pinPos = new google.maps.LatLng(lat, lng);
					

					
					var pinImg = {
					    url: exchangeImageURL[exchangeNumber[exchange]],
					    scaledSize: new google.maps.Size(iconSizeX, iconSizeY),
					    origin: new google.maps.Point(0, 0),
					    anchor: new google.maps.Point(iconSizeX/2, iconSizeY/2)
					};
					
					var pinMarker = new google.maps.Marker({
						position: pinPos,
						map: map,
						icon: pinImg,
						title: exchange.toLowerCase(),
						animation: google.maps.Animation.DROP
					});
					
					markersArray.push(pinMarker);
					gifteesArray.push(username);
					
					
					document.getElementById("undoPinButton").disabled = false;
					document.getElementById("mapLinkButton").disabled = false;
					
					
					google.maps.event.addListener(pinMarker, 'click', function() {
						//close current windows
						for (var j = 0; j < pinWindows.length; j++){
							pinWindows[j].close();
						}
					    pinWindow.open(map,this);
					  });
					  
					pinWindows.push(pinWindow);
					  
					google.maps.event.addListener(pinMarker, 'rightclick', function() {
					    var markerIndex = markersArray.indexOf(pinMarker);
					    
					    pinMarker.setMap(null);
					    pinMarker = null;
					    
					    
					    markersArray.splice(markerIndex, 1);
					    gifteesArray.splice(markerIndex, 1);
					    rematchesArray.splice(markerIndex, 1);
					    
					    if (markersArray[markersArray.length-1] == null){
							document.getElementById("undoPinButton").disabled = true;
							document.getElementById("mapLinkButton").disabled = true;

						}
					  });
					  
					  	map.setZoom(10);

					  
					  //fit map to include new pin
					     bounds.extend(pinPos);
					     map.fitBounds(bounds);   
					  //reset zoom   

				});
			}
			
		};
		
		function setHome(){
			
			if ( $('#home').val().localeCompare("") != 0){
				shareLinkURL = "http://redditgiftsmap.com/s/?";
				privateLinkURL = "http://redditgiftsmap.com/?";
				
				if (homeMarker != null){
					homeMarker.setMap(null);
					homeMarker = null;
				}
				geocoder = new google.maps.Geocoder();
				var post = $('#home').val();
				var user = $('#homeUsername').val();
	
				var lat;
				var lng;
				var homeDialog = '<div class="homeContent">';
				
				if (user.localeCompare("") != 0){
					homeDialog += '<p>home of <a href="http://reddit.com/u/' + user + '" target="_blank">/u/' + user + '</a></p>' + '</div>';
					shareLinkURL += user + ",";
					privateLinkURL += user + ",";
				}
				else{
					homeDialog += '<p>home sweet home</p>' + '</div>';
					shareLinkURL = "http://redditgiftsmap.com/s/?";
					privateLinkURL = "http://redditgiftsmap.com/?";
				}
				var homeWindow = new google.maps.InfoWindow({
				      content: homeDialog,
				      maxWidth: 100
				  });
				geocoder.geocode({address: post},
				function(results_array, status) { 
					lat = results_array[0].geometry.location.lat();
					lng = results_array[0].geometry.location.lng();
				
					var pinPos = new google.maps.LatLng(lat, lng);

					
					var pinImg = {
					    url: 'home@2x.png',
					    scaledSize: new google.maps.Size(homeIconDim, homeIconDim),
					    origin: new google.maps.Point(0, 0),
					    anchor: new google.maps.Point(homeIconDim/2, homeIconDim/2)
					};
					
					shareLinkURL += lat.toFixed(1) + "," + lng.toFixed(1);
					privateLinkURL += lat.toFixed(1) + "," + lng.toFixed(1);
					
					homeMarker = new google.maps.Marker({
						position: pinPos,
						map: map,
						icon: pinImg,
						title: "Home Sweet Home",
						animation: google.maps.Animation.DROP
					});
					

					

					
					google.maps.event.addListener(homeMarker, 'click', function() {
						//close current windows
						for (var j = 0; j < pinWindows.length; j++){
							pinWindows[j].close();
						}
					    homeWindow.open(map,this);
					  });
					  
					  pinWindows.push(homeWindow);
					  
					google.maps.event.addListener(homeMarker, 'rightclick', function() {
					    homeMarker.setMap(null);
					    homeMarker = null;
					    shareLinkURL = "http://redditgiftsmap.com/s/?";
					    privateLinkURL = "http://redditgiftsmap.com/?";
					  });
					  
					  	map.setZoom(10);

					  
					  //fit map to include new pin
					    bounds.extend(pinPos);
					    map.fitBounds(bounds);
					
				});
			}			
		};
		
		function undoPin(){
			pinToUndo = markersArray[markersArray.length-1];
			if (pinToUndo != null){
				pinToUndo.setMap(null);
				pinToUndo = null;
				markersArray.pop();
				gifteesArray.pop();
				rematchesArray.pop();
				if (markersArray[markersArray.length-1] == null){
					document.getElementById("undoPinButton").disabled = true;
					document.getElementById("mapLinkButton").disabled = true;

				}
			}
		};
		
		function closeShareLinks(){
			$('#dimmer').hide();
			$('#shareBox').hide();
/* 			$('#closeShareBox').hide(); */
		}
		
		function setLinks(){
			var encodedPinInfo = "&";
			
			for (var i = 0; i < markersArray.length; i++){
				// encodedPinInfo += encodeURIComponent(markersArray[i].getTitle()) + ","; //for exchange name
				encodedPinInfo += exchangeNumberLowerCase[markersArray[i].getTitle()] + ","
				encodedPinInfo += markersArray[i].getPosition().lat().toFixed(1).toString() + ","; //for lat position
				encodedPinInfo += markersArray[i].getPosition().lng().toFixed(1).toString(); //for lng position
				//check to see if giftee is empty string or not. if not, add comma and giftee name
				if (gifteesArray[i].localeCompare("") != 0){
					encodedPinInfo += "," + gifteesArray[i];
				}
				//check to see if rematch or not. if yes, add another comma
				if (rematchesArray[i]){
					encodedPinInfo += ",";
				}
				encodedPinInfo += "&";
			}
			
			
			var printedShareLink = document.getElementById("shareLink");
			var printedPrivateLink = document.getElementById("privateLink");
			var shareLinkToSet = shareLinkURL + encodedPinInfo;
			var privateLinkToSet = privateLinkURL + encodedPinInfo;
			//link shortening:
			var request2 = gapi.client.urlshortener.url.insert({
				'resource': {
				  'longUrl': privateLinkToSet
				}
				});
			request2.execute(function(response2) 
					{
				
						if(response2.id != null)
						{
							privateLinkToSet = response2.id;
						}
						printedPrivateLink.innerHTML = privateLinkToSet;
						printedPrivateLink.setAttribute('href', privateLinkToSet);
					});
			//link shortening:
			var request = gapi.client.urlshortener.url.insert({
				'resource': {
				  'longUrl': shareLinkToSet
				}
				});
			request.execute(function(response) 
					{
				
						if(response.id != null)
						{
							// alert(response.id);
							shareLinkToSet = response.id;
						}
						printedShareLink.innerHTML = shareLinkToSet;
						printedShareLink.setAttribute('href', shareLinkToSet);
					});
		
		
						
			
		}
		
		//for URL shortening
		function load() {
		  gapi.client.setApiKey('AIzaSyBauEtRQ17iTKbRU3wC4QdFJ9ZzgJeHFF8');
		  gapi.client.load('urlshortener', 'v1',function(){});
		}
		

		
		$(document).ready(function(){		
			/* $('#shareBox').hide(); */
			
			$('#mapLinkButton').click(function() {
				setLinks();
				$('#shareBox').css("display", "inline-block");
/* 				$('#closeShareBox').css("display", "inline-block"); */
				$('#dimmer').show();
				});
	
		/* This allows the user to press enter rather than the start encryption button while in the rule number form box */
		  $("input").keypress(function(event) {
		    if (event.which == 13 && $('#postCode').val().localeCompare("") != 0) {
		        $("#dropPinButton").click();
		    }
	  });
	  
    
}); 
	    </script>
	    
	    <script src="https://apis.google.com/js/client.js?onload=load"></script>
    
  </head>
  <body>
  <div id="dimmer"></div>
  <div>
  	<h1><span style="color:#ff5700">reddit</span><span style="color:#336699">gifts</span> map</h1>
  	<p><span style="color:#666666">required</span> fields denoted by an *<br>
	  	click <span style="color:#666666">generate links</span> after adding all pins
<br>save <span style="color:#666666">private link</span> to edit map later
<br>use <span style="color:#666666">share link</span> to share with others 
  	</p>
  </div>
  	  	<div id="shareBox">
  	  		<a href="javascript:closeShareLinks();"><div id="closeButton"></div></a>
  	  		<!-- <div id="closeShareBox"><a href="javascript:closeShareLinks();"><img src="x.png" alt="close" height="10" width="10"/></a></div> -->
  	  		<p>Private link: <a href="" id="privateLink" target=_blank></a>
	  	  	<br>Share link: <a href="" id="shareLink" target=_blank></a> <!-- change this to actual link later -->
	  	  	<!-- <br><br><a href="javascript:closeShareLinks();"><img src="x.png" alt="close" height="10" width="10"/></a> -->
	  	  	</p>
  	</div>

  	<div id="wrapper">
  	<div id="userBox"><h2>your info</h2>
  	<p>set home location for reference<br>
  	<br>post code<span style="color:#ff5700">*</span> <input type="text" id="home" size="10" value=""><br>
  	username <input type="text" id="homeUsername" size="10" value=""><br>
  	<input id="setHomeButton" type="button" onclick="setHome()" value="set home location"></p></div>
  	<div id="gifteeBox"><h2>giftee's info</h2>
  	<p>drop giftee pins for each exchange<br><br>
  	exchange<span style="color:#336699">*</span> <select id="exchangeList"> 
	  <option></option>
	  <!-- use the python script (part one) to generate the below part of the drop-down: -->
		<option>Tim Burton</option>
		<option>Hockey</option>
		<option>Makeup & Nail Polish 2014</option>
		<option>Marvel Universe</option>
		<option>Ugly Mugs</option>
		<option>Puzzles</option>
		<option>Tabletop RPGs</option>
		<option>Soccer</option>
		<option>T-shirt 2014</option>
		<option>Ties 2014</option>
		<option>Archer</option>
		<option>Books 2014</option>
		<option>Ghostbusters</option>
		<option>Jim Henson</option>
		<option>LEGO</option>
		<option>Stickers</option>
		<option>Yarn 2014</option>
		<option>Socks 2014</option>
		<option>Snacks 2014</option>
		<option>100th Exchange Extravaganza!</option>
		<option>DC Comics</option>
		<option>Harry Potter</option>
		<option>Lunchboxes</option>
		<option>Awesome Aprons</option>
		<option>Studio Ghibli</option>
		<option>Dinosaurs</option>
		<option>Holiday Cards 2013</option>
		<option>Secret Santa 2013</option>
		<option>reddit Trick or Treat 2013</option>
		<option>reddit Trick or Treat 2013 PLUS</option>
		<option>Presents for Pets 2013</option>
		<option>Whedon-Verse</option>
		<option>Blind Boxes and Bags</option>
		<option>NFL</option>
		<option>Avatar: The Last Airbender</option>
		<option>Board Games 2013</option>
		<option>Breaking Bad</option>
		<option>Kitchen Goods</option>
		<option>Trading Card Games</option>
		<option>Zombies</option>
		<option>redditgifts for the Teachers 2013</option>
		<option>The World's End Exchange</option>
		<option>The World's End Exchange PLUS</option>
		<option>Now Sharing Absurdity - The NSA Gift Exchange</option>
		<option>Arrested Development Exchange</option>
		<option>Hometown Exchange</option>
		<option>Game of Thrones Exchange</option>
		<option>Magnets Exchange</option>
		<option>Pints and Shot Glasses Exchange</option>
		<option>Nintendo Exchange</option>
		<option>Arbitrary Day 2013</option>
		<option>Arbitrary Day PLUS 2013</option>
		<option>Nostalgia Exchange</option>
		<option>Star Trek Exchange</option>
		<option>Disney Exchange</option>
		<option>Pens and Stationery Exchange</option>
		<option>Doctor Who (Almost) 50th Anniversary Exchange</option>
		<option>Phone Cases Exchange</option>
		<option>Ameristralia Exchange</option>
		<option>Star Wars Exchange</option>
		<option>Condiments Exchange</option>
		<option>Plushy Exchange</option>
		<option>Art Prints Exchange</option>
		<option>Simple Pleasures Exchange</option>
		<option>Awesome Smell Exchange</option>
		<option>Horror Exchange</option>
		<option>Manga Exchange</option>
		<option>T-shirt Exchange</option>
		<option>Adventure Time Exchange</option>
		<option>Fantasy Exchange</option>
		<option>Yarn Exchange 2013</option>
		<option>Book Exchange 2013</option>
		<option>Socks Exchange</option>
		<option>Coffee and Tea Exchange</option>
		<option>Hats and Scarves Exchange</option>
		<option>Snack Exchange 2013</option>
		<option>Pokemon Exchange</option>
		<option>Holiday Greeting Card Exchange</option>
		<option>Secret Santa 2012</option>
		<option>reddit Trick or Treat 2012</option>
		<option>reddit Trick or Treat PLUS</option>
		<option>Decorate my Cubicle</option>
		<option>Makeup and Nail Polish</option>
		<option>Ties</option>
		<option>Postcards</option>
		<option>Doctor Who</option>
		<option>reddit Gifts for the Teachers</option>
		<option>Comic Books and Graphic Novels</option>
		<option>Decorate Your Dorm</option>
		<option>Vinyl Exchange</option>
		<option>Presents for Pets</option>
		<option>Arbitrary Day PLUS</option>
		<option>Arbitrary Day 2012</option>
		<option>redditgifts for the troops</option>
		<option>Awesomesocks</option>
		<option>Board Games</option>
		<option>My Little Pony</option>
		<option>Cookbooks</option>
		<option>yarn exchange 2012</option>
		<option>r/books 2012</option>
		<option>T-Shirts 2012</option>
		<option>Secret Santa 2011</option>
		<option>Coffee Mugs and Tea Cups 2011</option>
		<option>reddit Trick or Treat 2011</option>
		<option>Arbitrary Day 2011</option>
		<option>r/snackexchange 2011</option>
		<option>r/craftexchange 2011</option>
		<option>r/books 2011</option>
		<option>Secret Santa 2010</option>
		<option>Arbitrary Day 2010</option>
		<option>Secret Santa 2009</option>
		<!-- use the python script (part one) to generate the above part of the drop-down: -->
	</select><br>
  	post code<span style="color:#336699">* </span><input type="text" id="postCode" size="10" value=""><br>
  	username <input type="text" id="gifteeUsername" size="10" value=""><br>
  	rematch? <input type="checkbox" id="rematchCheck"><br>

  	<input id="dropPinButton" type="button" onclick="dropPin()" value="drop pin!"> 
  	<input id="undoPinButton" type="button" onclick="undoPin()" value="undo pin" disabled><p></div>
  	</div>
  	<div id="bottomWrapper"></div>
  	<div><p><br><span style="color:#666666">click</span> dropped pins for more info
  	<br><span style="color:#666666">right click</span> to remove any pin	
  	</p>
  	<input id="mapLinkButton" type="button" value="generate links" disabled></div>

    <div id="map-canvas"></div>
    <div id="copyright">this site is not affiliated with nor endorsed by <a href="http://www.reddit.com">reddit</a> or <a href="http://www.redditgifts.com">redditgifts</a><br><br>emilie menard barnard<br><a href="http://emiliebarnard.com">emiliebarnard.com</a><br><a href="http://www.reddit.com/user/Fluffaykitties/">/u/fluffaykitties</a></div>
  </body>
</html>
